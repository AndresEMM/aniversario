<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sendero bajo la luna</title>
<style>
  :root{
    --skyTop:#0a0f24;
    --skyMid:#121939;
    --skyBot:#161c2b;
    --moon:#f2f4f8;
    --far:#1b2240;       /* montañas lejanas */
    --mid:#0e142b;       /* bosque medio */
    --near:#0a1022;      /* bosque cercano */
    --pathA:#4a3a29;     /* camino */
    --pathB:#2a2119;
    --edge:#20170f;      /* borde del camino */
    --grassA:#0b1120;    /* vegetación */
    --rock:#5d646d;      /* roca */
    --halo:#ffefc1;      /* luz linterna */
    --fog:#c7d2fe24;     /* niebla */
    --firefly:#ffd36b;   /* luciérnaga */
  }
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%;overflow:hidden;background:linear-gradient(180deg,var(--skyTop),var(--skyMid) 55%,var(--skyBot))}
  body{font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:#e8ecff}

  /* Escena base */
  .scene{position:relative;width:100%;height:100%}
  .layer{position:absolute;inset:0;pointer-events:none}

  /* Estrellas y luna */
  .stars{background:
      radial-gradient(1px 1px at 12% 18%, #fff8 50%, transparent 52%),
      radial-gradient(1px 1px at 38% 12%, #fff7 50%, transparent 52%),
      radial-gradient(1px 1px at 70% 25%, #fff6 50%, transparent 52%),
      radial-gradient(1px 1px at 82% 40%, #fff9 50%, transparent 52%),
      radial-gradient(1px 1px at 28% 62%, #fff7 50%, transparent 52%),
      radial-gradient(1px 1px at 58% 72%, #fff6 50%, transparent 52%),
      radial-gradient(1px 1px at 80% 84%, #fff5 50%, transparent 52%);
    animation: twinkle 8s ease-in-out infinite}
  @keyframes twinkle{0%,100%{opacity:.95}50%{opacity:.6}}

  .moon{
    position:absolute;top:7vh;left:10vw;width:120px;height:120px;border-radius:50%;
    background:radial-gradient(120px 100px at 35% 35%,var(--moon),#e5e8f0 52%,#cfd4df 68%,#aab2c3 86%,#8891a5);
    box-shadow:0 0 36px 8px #e9eef766;filter:contrast(1.05) brightness(1.02)
  }

  /* Parallax lejano (montañas y bosque) */
  .far svg,.mid svg,.near svg{width:120%;height:100%;position:absolute;left:-10%}
  .far path{fill:var(--far)} .mid path{fill:var(--mid)} .near path{fill:var(--near)}
  @keyframes driftFar{from{transform:translateX(0)}to{transform:translateX(-5%)}}
  @keyframes driftMid{from{transform:translateX(0)}to{transform:translateX(-10%)}}
  .far{animation: driftFar 40s linear infinite alternate}
  .mid{animation: driftMid 26s linear infinite alternate}

  /* Niebla en capas */
  .fog{position:absolute;inset:auto 0 10vh 0;height:30vh;z-index:3;pointer-events:none}
  .fog::before,.fog::after{
    content:"";position:absolute;left:-30%;right:-30%;top:8%;
    height:120%;background:radial-gradient(40% 60% at 50% 50%,var(--fog),transparent 70%);
    animation:fogMove 28s linear infinite}
  .fog::after{animation-duration:38s;top:0%}
  @keyframes fogMove{from{transform:translateX(0)}to{transform:translateX(22%)}}

  /* Suelo con camino central (perspectiva) */
  .ground{position:absolute;inset:0;display:flex;align-items:flex-end;z-index:4}
  .path{
    position:relative;margin:0 auto;width:min(64vw, 980px);min-width:300px;height:64vh;
    background:linear-gradient(180deg,#5a4734 0%,var(--pathA) 52%,#1c130b 100%);
    clip-path:polygon(50% 0%, 68% 8%, 80% 16%, 88% 26%, 92% 36%, 95% 48%, 97% 60%, 98% 72%, 99% 86%, 100% 100%,
                      0% 100%, 1% 86%, 2% 72%, 3% 60%, 5% 48%, 8% 36%, 12% 26%, 20% 16%, 32% 8%);
    border-left:8px solid var(--edge);
    border-right:8px solid var(--edge);
    filter:drop-shadow(0 20px 35px rgba(0,0,0,.45))
  }

  /* Lados del camino: vegetación y rocas (capas) */
  .banks{position:absolute;inset:auto 0 0 0;height:25vh;display:grid;grid-template-columns:1fr min(64vw,980px) 1fr;gap:0;z-index:5}
  .bank{position:relative;overflow:hidden}
  .bank::before{
    content:"";position:absolute;inset:0;
    background:
      radial-gradient(70px 18px at 14% 86%, #0f172a 40%, transparent 52%),
      radial-gradient(90px 18px at 34% 92%, #0b1324 40%, transparent 52%),
      radial-gradient(70px 18px at 58% 88%, #0f172a 40%, transparent 52%),
      radial-gradient(90px 18px at 78% 90%, #0b1324 40%, transparent 52%),
      linear-gradient(180deg,#091022 0%,#070c19);
    opacity:.9
  }

  /* Rocas de distintos tamaños */
  .rock{position:absolute;bottom:0;background:linear-gradient(180deg,#7b838d,#4e565f 60%,#383f47 100%);
        border-radius:20% 30% 12% 30%/25% 40% 25% 35%;transform:rotate(var(--rot,0deg));
        box-shadow:inset 0 8px 18px rgba(255,255,255,.06),0 8px 18px rgba(0,0,0,.25)}
  .rock::after{content:"";position:absolute;inset:8% 12% auto 12%;height:36%;
        background:radial-gradient(60% 80% at 40% 30%,#fff2 0%,transparent 70%);border-radius:50%}

  /* Matitas/arbustos */
  .bush{position:absolute;bottom:0;width:120px;height:70px;filter:drop-shadow(0 6px 12px rgba(0,0,0,.4))}
  .b{position:absolute;bottom:0;border-radius:50%}
  .b.g1{left:0;width:70px;height:45px;background:#0e1b33}
  .b.g2{left:30px;width:60px;height:40px;background:#0b162b}
  .b.g3{left:58px;width:50px;height:36px;background:#0a1326}

  /* Luciérnagas */
  .fireflies{pointer-events:none;z-index:6}
  .fly{position:absolute;width:4px;height:4px;border-radius:50%;background:var(--firefly);
       box-shadow:0 0 6px 2px var(--firefly);opacity:.85;filter:saturate(1.1)}
  @keyframes fire{0%,100%{transform:translate(0,0)}25%{transform:translate(10px,-8px)}50%{transform:translate(-4px,-2px)}75%{transform:translate(6px,10px)}}
  @keyframes glow{0%,100%{opacity:.9}50%{opacity:.4}}

  /* Linterna (halo) */
  .halo{position:fixed;inset:0;pointer-events:none;opacity:0;transition:opacity .25s ease;mix-blend-mode:screen;z-index:7}
  .halo.active{opacity:1}
  .halo::before{
    content:"";position:absolute;left:var(--x,50%);top:var(--y,60%);transform:translate(-50%,-50%);
    width:36vmax;height:36vmax;border-radius:50%;
    background:radial-gradient(closest-side,var(--halo) 0%,#ffe9a000 60%);
    filter:blur(1px) brightness(1.05)
  }

  /* Botón linterna */
  .toggle{position:fixed;right:14px;top:14px;z-index:10;border:1px solid #ffffff22;border-radius:999px;
    background:#0b1022aa;color:#fff;padding:.55rem .9rem;font-weight:700;backdrop-filter:blur(6px);cursor:pointer}
  .toggle:active{transform:translateY(1px)}

  /* Hotspots (aparecen solo si la linterna está cerca) */
  .hotspot{position:absolute;width:28px;height:28px;border-radius:50%;
    transform:translate(-50%,-50%);pointer-events:auto;opacity:0;z-index:8}
  .hotspot.visible{opacity:1;box-shadow:0 0 0 2px #fff3,0 0 16px 6px #ffd36b88, inset 0 0 10px 2px #fff2;background:#fff1}
  .hotspot:after{content:"";position:absolute;inset:-10px;border-radius:50%;}

  /* Panel de mensaje romántico */
  .overlay{position:fixed;inset:0;display:none;place-items:center;background:rgba(6,8,14,.78);
    backdrop-filter:blur(5px);z-index:20;padding:18px}
  .overlay.active{display:grid}
  .card{max-width:780px;background:linear-gradient(180deg,#12172b,#0d1224);border:1px solid #ffffff22;border-radius:16px;
    padding:22px;box-shadow:0 18px 50px rgba(0,0,0,.5);text-align:center}
  .card h2{font-size:clamp(1.4rem,3.4vw,2.2rem);color:#ffe6a6;margin-bottom:.6rem}
  .card p{font-size:clamp(1rem,2.2vw,1.15rem);line-height:1.7;color:#e9edffcc}
  .close{margin-top:14px;border:1px solid #ffffff33;border-radius:999px;background:#1a2144;color:#fff;
    padding:.55rem 1rem;cursor:pointer}
  .close:active{transform:translateY(1px)}
</style>
</head>
<body>
<button class="toggle" id="toggle">Linterna: Apagar / Encender</button>

<div class="scene" id="scene">
  <div class="layer stars"></div>
  <div class="layer moon"></div>

  <!-- Montañas lejanas -->
  <div class="layer far" aria-hidden="true">
    <svg viewBox="0 0 1200 600" preserveAspectRatio="none">
      <path d="M0,420 L100,360 240,410 360,300 480,380 600,320 720,360 840,290 960,350 1080,310 1200,360 1200,600 0,600 Z"/>
    </svg>
  </div>

  <!-- Bosque medio -->
  <div class="layer mid" aria-hidden="true">
    <svg viewBox="0 0 1200 600" preserveAspectRatio="none">
      <path d="M0,460 
               C60,420 80,420 120,460
               C160,420 180,420 220,460
               C260,420 280,420 320,460
               C360,420 380,420 420,460
               C460,420 480,420 520,460
               C560,420 580,420 620,460
               C660,420 680,420 720,460
               C760,420 780,420 820,460
               C860,420 880,420 920,460
               C960,420 980,420 1020,460
               C1060,420 1080,420 1120,460
               L1200,600 0,600 Z"/>
    </svg>
  </div>

  <!-- Niebla -->
  <div class="layer fog"></div>

  <!-- Suelo y camino -->
  <div class="layer ground">
    <div class="path"></div>
  </div>

  <!-- Orillas: vegetación y rocas -->
  <div class="banks">
    <div class="bank" id="leftBank"></div>
    <div></div>
    <div class="bank" id="rightBank"></div>
  </div>

  <!-- Luciérnagas -->
  <div class="layer fireflies" id="flies"></div>

  <!-- Hotspots (se agregan por JS) -->
  <div id="hotspots"></div>

  <!-- Halo linterna -->
  <div class="halo" id="halo"></div>
</div>

<!-- Mensaje romántico -->
<div class="overlay" id="overlay">
  <div class="card">
    <h2 id="title"></h2>
    <p id="text"></p>
    <button class="close" id="close">Cerrar</button>
  </div>
</div>

<script>
/* ---------- Vegetación y rocas en las orillas ---------- */
function addRock(parent, xPct, w, h, rot){
  const r = document.createElement('div');
  r.className = 'rock';
  r.style.left = xPct + '%';
  r.style.width = w + 'px';
  r.style.height = h + 'px';
  r.style.setProperty('--rot', rot + 'deg');
  parent.appendChild(r);
}
function addBush(parent, xPct, scale){
  const b = document.createElement('div');
  b.className = 'bush';
  b.style.left = xPct + '%';
  b.style.transform = `scale(${scale})`;
  b.innerHTML = '<div class="b g1"></div><div class="b g2"></div><div class="b g3"></div>';
  parent.appendChild(b);
}
const left = document.getElementById('leftBank');
const right = document.getElementById('rightBank');
[10,22,34,46,58,70,82,92].forEach((x,i)=>{ addBush(left,x, 0.8+Math.random()*0.5); if(i%2===0) addRock(left,x+3, 36+Math.random()*24, 22+Math.random()*20, -6+Math.random()*12); });
[8,18,28,40,52,66,78,90].forEach((x,i)=>{ addBush(right,x, 0.8+Math.random()*0.5); if(i%2===1) addRock(right,x-2, 36+Math.random()*24, 22+Math.random()*22, -10+Math.random()*20); });

/* ---------- Luciérnagas ---------- */
const flies = document.getElementById('flies');
const COUNT = 22;
for(let i=0;i<COUNT;i++){
  const d = document.createElement('div');
  d.className = 'fly';
  d.style.left = (Math.random()*100) + 'vw';
  d.style.top  = (40 + Math.random()*55) + 'vh';
  d.style.animation = `fire ${6+Math.random()*6}s ease-in-out ${Math.random()*2}s infinite, glow ${2+Math.random()*2}s ease-in-out ${Math.random()}s infinite`;
  flies.appendChild(d);
}

/* ---------- Linterna ---------- */
const halo = document.getElementById('halo');
const toggle = document.getElementById('toggle');
let lampOn = false;
function setPos(e){
  if(!lampOn) return;
  const p = e.touches ? e.touches[0] : e;
  halo.style.setProperty('--x', p.clientX + 'px');
  halo.style.setProperty('--y', p.clientY + 'px');
  revealHotspots(p.clientX, p.clientY);
}
['mousemove','touchmove'].forEach(ev=>window.addEventListener(ev,setPos,{passive:true}));
toggle.addEventListener('click', ()=>{
  lampOn = !lampOn; halo.classList.toggle('active', lampOn);
  if(!lampOn) hideAllHotspots();
});

/* ---------- Hotspots (puntos secretos clicables) ---------- */
const hotspotData = [
  {
    x: 0.36, y: 0.62,
    title: "Pequeño resplandor",
    text: "A veces el mundo se calma cuando escucho tu voz. Gracias por ser mi rincón favorito del día."
  },
  {
    x: 0.52, y: 0.50,
    title: "Entre pinos",
    text: "Aunque el camino sea largo, contigo cada paso tiene la distancia justa para sonreír."
  },
  {
    x: 0.62, y: 0.68,
    title: "Roca del norte",
    text: "Si alguna vez el viento arrecia, prometo ser abrigo y mapa. Me encanta caminar contigo."
  }
];
const hotspotsRoot = document.getElementById('hotspots');
const hotspots = [];
hotspotData.forEach(h=>{
  const el = document.createElement('div');
  el.className = 'hotspot';
  el.style.left = (h.x*100) + 'vw';
  el.style.top  = (h.y*100) + 'vh';
  el.dataset.title = h.title;
  el.dataset.text  = h.text;
  el.addEventListener('click', ()=>{ if(lampOn && el.classList.contains('visible')) openOverlay(el.dataset.title, el.dataset.text); });
  hotspotsRoot.appendChild(el);
  hotspots.push({el, x:h.x, y:h.y});
});

function revealHotspots(cx, cy){
  const r = Math.min(window.innerWidth, window.innerHeight)*0.13; // radio de detección
  hotspots.forEach(h=>{
    const hx = h.x*window.innerWidth;
    const hy = h.y*window.innerHeight;
    const d = Math.hypot(hx - cx, hy - cy);
    h.el.classList.toggle('visible', d <= r);
  });
}
function hideAllHotspots(){ hotspots.forEach(h=>h.el.classList.remove('visible')); }

/* ---------- Overlay de texto ---------- */
const overlay = document.getElementById('overlay');
const title = document.getElementById('title');
const text  = document.getElementById('text');
const closeBtn = document.getElementById('close');
function openOverlay(t, msg){
  title.textContent = t;
  text.textContent  = msg;
  overlay.classList.add('active');
}
closeBtn.addEventListener('click', ()=> overlay.classList.remove('active'));
overlay.addEventListener('click', (e)=>{ if(e.target===overlay) overlay.classList.remove('active'); });

/* ---------- Parallax suave con el mouse ---------- */
let targetX = 0, targetY = 0, cx=0, cy=0;
window.addEventListener('mousemove', (e)=>{
  targetX = (e.clientX / innerWidth - .5);
  targetY = (e.clientY / innerHeight - .5);
});
function parallax(){
  cx += (targetX - cx)*0.04;
  cy += (targetY - cy)*0.04;
  document.querySelector('.far').style.transform = `translate(${cx*10}px, ${cy*4}px)`;
  document.querySelector('.mid').style.transform = `translate(${cx*18}px, ${cy*6}px)`;
  requestAnimationFrame(parallax);
}
parallax();

/* ---------- Accesibilidad táctil: centrar halo al tocar ---------- */
window.addEventListener('touchstart', e=>{ if(!lampOn) return; const t=e.touches[0]; setPos(t); }, {passive:true});
</script>
</body>
</html>
